{
  "name": "Restful-api-flask",
  "tagline": "",
  "body": "<!-- ## I. Definition\r\n## II. Next def\r\n\r\n### Project Overview\r\n\r\nAn [estimated 2 trillion photos](http://ben-evans.com/benedictevans/2015/8/19/how-many-pictures)\r\n\r\n![AltraNikeLogo](images/AltraNikeLogo.png) -->\r\n\r\n## REST Architecture\r\n\r\nRepresentational state transfer (REST) originally specified in the [5th chapter](http://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm) of Roy Fielding's PhD thesis \"Architectural Styles and\r\nthe Design of Network-based Software Architectures\" which specifies 6 constraints for the REST architecture.\r\n\r\n1. Client-Server - API is separated from a client.  Although this could represent different processes within a single computer.  The objective is to allow for scalability- mulitple clients and multiple types of clients can thus connect with a single API.\r\n1. Stateless - [No](http://programmers.stackexchange.com/questions/141019/should-cookies-be-used-in-a-restful-api) [cookies](http://stackoverflow.com/questions/319530/restful-authentication) and no sessions.  Clients must authenticate upon every request.\r\n1. Cache - Server should provide caching directives so that in the event that a similar request arrives multiple times, a response can be provided without requiring a repeated request to the server.  There are a variety of caches, including inside of the browser.\r\n1. Layered System - Both the client and the API may or may not be communicating directly with the other.  Likely there's a layer in between (such as a load balancer).  This prevents a server from identifying requests by the client, in the case of a load-balancer, a server may receive *ALL* of its requests from a single client.  The benefit of this is that in the event that a load balancer is placed in between the server and the client, you now have the ability to scale to a huge number of clients and servers without requiring fundamental changes.\r\n1. Code-On-Demand - In practice this is an optional REST principle.  Clients can receive executable code to run as a response to a request.  How would an API know what types of code that a client could run?\r\n1. Uniform Interface -\r\n\t1. Identification of resources - Resources represent every entity in the domain of the application.  Each resource gets its own unique identifier URI such as: `/img/api/v1.0/images/3`. Collections of resources can also have identifiers such as `/img/api/v1.0/images`.\r\n\t1. Resource Representations - Clients only access representations of a resource, never the resource itself.  Additionally, clients only operate on representations of resources. The server may provide a number of different content types, like JSON or XML.\r\n\t1. Self-Descriptive Message - Clients send and receive HTTP.  Request method defines the operation; target is represented in the URI of the request, headers provide authentication credentials and content types, the representation of the resource is in the body, and the result of an operation is in the response status code.\r\n\t1. HATEOAS [Hypermedia As The Engine Of Application State](https://en.wikipedia.org/wiki/HATEOAS) - Clients don't know any resource URIs except for the root of the API and everything else can be discovered through links in resource representations.\r\n\r\nREST defines an architectural style used in web development.  Because it defined an architecture and not a specification, there is room for interpretation.\r\n\r\n## What I built\r\n\r\nCan you teach a computer to recognize  the brand logos of Nike and Altra in an unlabeled feed of images from Instagram?\r\n\r\nIn a [previous project](chriskaschner.com/retraining), I created a Convolutional Neural Network (CNN) that identify brand logos in untagged/ unlabeled photos from a social media feed.  The model I used implemented a [previously trained](https://github.com/tensorflow/models/tree/master/inception) network and [transfer learning](https://en.wikipedia.org/wiki/Inductive_transfer).\r\n\r\nFor this project I wanted to build a REST API that allowed me to connect to my previous work building a  \r\n\r\n###### How my project meets REST constraints\r\n\r\n1. Client-Server - Yes, the API is hosted on a server both physically and logically separated from the clients I'm using to consume it.\r\n1. Stateless - Yes, outside of the root URI for the API clients must authenticate upon every request.  Although as listed in the below improvements section, adding rate limiting would potentially remove this constraint.  In a statelsss system how would you identify an un-authenticated user in order to limit their number of requests?\r\n1. Cache - Yes, this is being met when the API is consumed in a browser.  However, as discussed in the below improvement section, adding etags would improve the existing solution.\r\n1. Layered System - Yes, Similar to Client-Server above, all requests are authenticated separately, and there are no systems in place that would attempt to identify a client merely by its requests.\r\n1. Code-On-Demand - No, I do not meet this [optional requirement](https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm#sec_5_1_7) of REST.  One potential application that I could see this constraint being used for is to download and execute JavaScript in the browser.\r\n1. Uniform Interface -\r\n\t1. Identification of resources - Yes, each resource gets its own unique identifier URI such as: `/img/api/v1.0/images/3` and each collections of resources has an udentifier `/img/api/v1.0/images`.\r\n\t1. Resource Representations - Yes, clients can only operate on representations of resources.  In this case, the server only provides JSON content.\r\n\t1. Self-Descriptive Message - Yes, the target is represented by the URI of the request, headers provide authentication credentials and content types, the representation of the resource is in the body, and the result of an operation is in the response status code.  Request methods define the operation being performed as follows:\r\n\t\t- GET requests get data\r\n\t\t- POST requests create new data\r\n\t\t- PUT requests update existing data - although there's a [differing opinion](https://stormpath.com/blog/fundamentals-rest-api-design) that says you should use POST for everything.\r\n\t\t- DELETE requests delete data\r\n\r\n\t1. HATEOAS [Hypermedia As The Engine Of Application State](https://en.wikipedia.org/wiki/HATEOAS) - Yes, Every resource request returns a URI property (except DELETE) that is the full URI of where a resource resides.  Potential improvments for this feature are discussed below.\r\n\r\n###### Versioning\r\nThere's some argument about *where* to place the version information for your API, but not *if* you should version it.  I place versioning info in the URI.  The other alternative is in the header.\r\n\r\n##### Authentication\r\nI use HTTP Basic Auth\r\n\r\n###### JSON\r\nIt's ubiquitous.  It's human readable.  It's easy to work with.\r\n\r\n### References\r\nhttp://www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api\r\n[Miguel Grinberg - Is Your REST API RESTful? - PyCon 2015](https://www.youtube.com/watch?v=pZYRC8IbCwk)\r\n\r\n\r\n\r\n### Unit Tests\r\n\r\n- Unit tests are included in the file `test_app.py`\r\n-  Also, include tests that validate success.\r\n\r\nBelow is sample output from running the unit tests.  Note that there is a deprecation warning from TensorFlow that is expected.\r\n```\r\n\t$ python test_app.py\r\n\t..........W tensorflow/core/framework/op_def_util.cc:332] Op BatchNormWithGlobalNormalization is deprecated. It will cease to work in GraphDef version 9. Use tf.nn.batch_normalization().\r\n\t...\r\n\t----------------------------------------------------------------------\r\n\tRan 13 tests in 4.186s\r\n\r\n\tOK\r\n```\r\n\r\n\r\n## 3 endpoints\r\n### 1. Images File Store\r\n|  HTTP Method |                           URI                  |             Action           |\r\n|--------------|------------------------------------------------|------------------------------|\r\n|     GET      |        [hostname]/img/api/v1.0/imgs            | Retrieve list of images      |  \r\n|     POST     |        [hostname]/img/api/v1.0/imgs            | Create new image             |\r\n|     GET      |        [hostname]/img/api/v1.0/imgs/[img_id]   | Retrieve an individual image |  \r\n|     PUT      |        [hostname]/img/api/v1.0/imgs/[img_id]   | Update an existing image     |\r\n|     DELETE   |        [hostname]/img/api/v1.0/imgs/[img_id]   | Delete an existing image     |\r\n\r\n\r\n#### GET [hostname]/img/api/v1.0/imgs\r\n<pre class=\"embedcurl\">curl -i http://10la.pythonanywhere.com/img/api/v1.0/images</pre>\r\n\r\n##### Results:\r\n```\r\nHTTP/1.0 200 OK\r\nContent-Type: application/json\r\nContent-Length: 502\r\nServer: Werkzeug/0.9.6 Python/2.7.12\r\nDate: Wed, 24 Aug 2016 22:06:07 GMT\r\n\r\n{\r\n  \"images\": [\r\n    {\r\n      \"resize\": false,\r\n      \"results\": \"\",\r\n      \"size\": \"\",\r\n      \"title\": \"Nikes\",\r\n      \"uri\": \"http://10la.pythonanywhere.com/img/api/v1.0/images/1\",\r\n      \"url\": \"http://imgdirect.s3-website-us-west-2.amazonaws.com/nike.jpg\"\r\n    },\r\n    {\r\n      \"resize\": false,\r\n      \"results\": \"\",\r\n      \"size\": \"\",\r\n      \"title\": \"Altra\",\r\n      \"uri\": \"http://10la.pythonanywhere.com/img/api/v1.0/images/2\",\r\n      \"url\": \"http://imgdirect.s3-website-us-west-2.amazonaws.com/altra.jpg\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n#### POST [hostname]/img/api/v1.0/imgs\r\n<pre class=\"embedcurl\">curl -u ReturnPath:python -i -H \"Content-Type: application/json\" -X POST -d '{\"url\":\"http://imgdirect.s3-website-us-west-2.amazonaws.com/neither.jpg\"}' http://10la.pythonanywhere.com/img/api/v1.0/images</pre>\r\n\r\n##### Results:\r\n\r\n```\r\nHTTP/1.0 201 CREATED\r\nContent-Type: application/json\r\nContent-Length: 233\r\nServer: Werkzeug/0.9.6 Python/2.7.12\r\nDate: Wed, 24 Aug 2016 22:13:57 GMT\r\n\r\n{\r\n  \"image\": {\r\n    \"resize\": false,\r\n    \"results\": \"\",\r\n    \"size\": \"\",\r\n    \"title\": \"\",\r\n    \"uri\": \"http://10la.pythonanywhere.com/img/api/v1.0/images/3\",\r\n    \"url\": \"http://imgdirect.s3-website-us-west-2.amazonaws.com/neither.jpg\"\r\n  }\r\n```\r\n\r\n#### GET [hostname]/img/api/v1.0/imgs/[img_id]\r\n\r\n<pre class=\"embedcurl\">curl -u ReturnPath:python -i http://10la.pythonanywhere.com/img/api/v1.0/image/3</pre>\r\n\r\n\r\n##### Results:\r\n\r\n```\r\nHTTP/1.0 200 OK\r\nContent-Type: application/json\r\nContent-Length: 186\r\nServer: Werkzeug/0.9.6 Python/2.7.12\r\nDate: Wed, 24 Aug 2016 22:19:02 GMT\r\n\r\n{\r\n  \"img\": {\r\n    \"id\": 3,\r\n    \"resize\": false,\r\n    \"results\": \"\",\r\n    \"size\": \"\",\r\n    \"title\": \"\",\r\n    \"url\": \"http://imgdirect.s3-website-us-west-2.amazonaws.com/neither.jpg\"\r\n  }\r\n```\r\n\r\n\r\n\r\n            |\r\n#### PUT [hostname]/img/api/v1.0/imgs/[img_id]\r\n\r\n<pre class=\"embedcurl\">curl -u ReturnPath:python -i -H \"Content-Type: application/json\" -X PUT -d '{\"title\":\"C-ron-ron\"}' http://10la.pythonanywhere.com/img/api/v1.0/images/3</pre>\r\n\r\n##### Results:\r\n\r\n```\r\nHTTP/1.0 200 OK\r\nContent-Type: application/json\r\nContent-Length: 195\r\nServer: Werkzeug/0.9.6 Python/2.7.12\r\nDate: Wed, 24 Aug 2016 22:43:20 GMT\r\n\r\n{\r\n  \"img\": {\r\n    \"id\": 3,\r\n    \"resize\": false,\r\n    \"results\": \"\",\r\n    \"size\": \"\",\r\n    \"title\": \"C-ron-ron\",\r\n    \"url\": \"http://imgdirect.s3-website-us-west-2.amazonaws.com/neither.jpg\"\r\n  }\r\n```\r\n\r\n#### DELETE [hostname]/img/api/v1.0/imgs/[img_id]\r\n\r\n<pre class=\"embedcurl\">curl -u ReturnPath:python -i -H \"Content-Type: application/json\" -X DELETE http://10la.pythonanywhere.com/img/api/v1.0/images/3</pre>\r\n\r\n##### Results:\r\n\r\n```\r\n\tHTTP/1.0 200 OK\r\n\tContent-Type: application/json\r\n\tContent-Length: 20\r\n\tServer: Werkzeug/0.9.6 Python/2.7.12\r\n\tDate: Wed, 24 Aug 2016 23:13:36 GMT\r\n\r\n\t{\r\n\t  \"result\": true\r\n\t}\r\n```\r\n\r\n## 2. Image Inference\r\n\r\n#### PUT [hostname]/img/api/v1.0/resize/[img_id]\r\n\r\n<pre class=\"embedcurl\">curl -u ReturnPath:python -X PUT -i -H \"Content-Type: application/json\" -d '{\"id\":2}' http://10la.pythonanywhere.com/img/api/v1.0/inference/2</pre>\r\n\r\n##### Results:\r\n```\r\n\tHTTP/1.0 200 OK\r\n\tContent-Type: application/json\r\n\tContent-Length: 415\r\n\tServer: Werkzeug/0.9.6 Python/2.7.12\r\n\tDate: Wed, 24 Aug 2016 22:47:30 GMT\r\n\r\n\t{\r\n\t  \"img\": {\r\n\t    \"id\": 2,\r\n\t    \"resize\": false,\r\n\t    \"results\": {\r\n\t      \"results_name_1\": \"neither\",\r\n\t      \"results_name_2\": \"altra\",\r\n\t      \"results_name_3\": \"nike\",\r\n\t      \"results_score_1\": \"\\\"0.7680\\\"\",\r\n\t      \"results_score_2\": \"\\\"0.2004\\\"\",\r\n\t      \"results_score_3\": \"\\\"0.0316\\\"\"\r\n\t    },\r\n\t    \"size\": \"\",\r\n\t    \"title\": \"Altra\",\r\n\t    \"url\": \"http://imgdirect.s3-website-us-west-2.amazonaws.com/altra.jpg\"\r\n\t  }\r\n\t}\r\n```\r\n\r\n## 3. Image Resize\r\n\r\n<pre class=\"embedcurl\">curl -u ReturnPath:python -i -H \"Content-Type: application/json\" -X PUT http://10la.pythonanywhere.com/img/api/v1.0/resize/3</pre>\r\n\r\n##### Results:\r\n```\r\n\tHTTP/1.0 200 OK\r\n\tContent-Type: application/json\r\n\tContent-Length: 235\r\n\tServer: Werkzeug/0.9.6 Python/2.7.12\r\n\tDate: Wed, 24 Aug 2016 23:18:53 GMT\r\n\r\n\t{\r\n\t  \"img\": {\r\n\t    \"id\": 2,\r\n\t    \"resize\": false,\r\n\t    \"results\": \"\",\r\n\t    \"size\": {\r\n\t      \"height\": 480,\r\n\t      \"width\": 480\r\n\t    },\r\n\t    \"title\": \"Altra\",\r\n\t    \"url\": \"http://imgdirect.s3-website-us-west-2.amazonaws.com/altra.jpg\"\r\n\t  }\r\n\t}\r\n```\r\n## Improvements:\r\n- better type checking for images\r\n- better authentication beyond HTTP Basic\r\n- [HTTPS for every request](http://flask.pocoo.org/snippets/111/)\r\n- Better [HATEOAS compliance](http://flask-restful-cn.readthedocs.io/en/0.3.5/)\r\n- [Improved caching](http://werkzeug.pocoo.org/docs/0.11/wrappers/#werkzeug.wrappers.ETagResponseMixin.make_conditional) via etags.\r\n- add pagination\r\n- add rate limiting\r\n- add direct upload to AWS S3 with [IAM roles](http://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-api.html)\r\n\r\n\r\n<script src=\"https://www.embedcurl.com/embedcurl.min.js\" async></script>\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}